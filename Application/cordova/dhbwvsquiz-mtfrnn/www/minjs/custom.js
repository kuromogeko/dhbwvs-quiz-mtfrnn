var globalQuizLoad,quests,logID,newQuestionTemplate='<div class="mdl-cell mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--12-col-phone mdl-card mdl-shadow--2dp  graybox " name="newQuestion">                        <div class="mdl-card__title max-height " style="background: linear-gradient(0deg,#00000044,#FFFFFF77),url(img/quiz.jpg)bottom right 15% repeat #2fa398">                            <h2 class="mdl-card__title-text">Frage Nummer: ${rid}</h2>                        </div>                        <div class="mdl-card__supporting-text mdl-card--expand">                            <form action="javascript:void(0);">                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">                                        <input class="mdl-textfield__input" name="dirtyInput" type="text" id="questionRunid${rid}">                                        <label class="mdl-textfield__label" for="questionRunid${rid}">Fragetext</label>                                    </div> <hr>                                                                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">                                  <input class="mdl-textfield__input is-dirty" type="text" name="dirtyInput" id="moneRunid${rid}">                                  <label class="mdl-textfield__label" for="monRunid${rid}">M&ouml;glichkeit 1</label>                                </div>                                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="moneswitchRunid${rid}">                                    <input type="checkbox" name="dirtyInput" id="moneswitchRunid${rid}" class="mdl-switch__input">                                    <span class="mdl-switch__label">Antwort stimmt</span>                                </label>                                                                      <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">                                    <input class="mdl-textfield__input" name="dirtyInput" type="text" id="mtwoRunid${rid}">                                    <label class="mdl-textfield__label" for="mtwoRunid${rid}">M&ouml;glichkeit 2</label>                                </div>                                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="mtwoswitchRunid${rid}">                                    <input type="checkbox" name="dirtyInput" id="mtwoswitchRunid${rid}" class="mdl-switch__input">                                    <span class="mdl-switch__label">Antwort stimmt</span>                                </label>                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">                                    <input class="mdl-textfield__input" name="dirtyInput" type="text" id="mthreeRunid${rid}">                                    <label class="mdl-textfield__label" for="mthreeRunid${rid}">M&ouml;glichkeit 3</label>                                </div>                                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="mthreeswitchRunid${rid}">                                    <input type="checkbox" name="dirtyInput" id="mthreeswitchRunid${rid}" class="mdl-switch__input">                                    <span class="mdl-switch__label">Antwort stimmt</span>                                </label>                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">                                    <input class="mdl-textfield__input" name="dirtyInput" type="text" id="mfourRunid${rid}">                                    <label class="mdl-textfield__label" for="mfourRunid${rid}">M&ouml;glichkeit 4</label>                                </div>                                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="mfourswitchRunid${rid}">                                    <input type="checkbox" name="dirtyInput" id="mfourswitchRunid${rid}" class="mdl-switch__input">                                    <span class="mdl-switch__label">Antwort stimmt</span>                                </label>                          </form>                        </div>                    </div>',listElementTmpl='<div class="mdl-cell mdl-cell--4-col-desktop mdl-cell--4-col-tablet mdl-cell--6-col-phone mdl-card mdl-shadow--2dp  graybox ">    <div name="QuizTitle" class="mdl-card__title max-height " style="background: linear-gradient(0deg,${Color}44,${Color}77),url(img/quiz.jpg)bottom right 15% no-repeat #2fa398">        <h2 class="mdl-card__title-text">${name}</h2>    </div>    <div class="mdl-card__supporting-text mdl-card--expand">    Kennungs-Nummer: ${id}    <hr>Von: ${creator}    <hr>Kategorie: ${category}    <hr>        ${description}    </div>    <div class="mdl-card__actions mdl-card--border">        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="playAQuiz(${id})">            Play        </button>    </div></div>',ownElementTmpl='<div class="mdl-cell mdl-cell--4-col-desktop mdl-cell--4-col-tablet mdl-cell--6-col-phone mdl-card mdl-shadow--2dp  graybox ">    <div name="QuizTitle" class="mdl-card__title max-height " style="background: linear-gradient(0deg,${Color}44,${Color}77),url(img/quiz.jpg)bottom right 15% no-repeat #2fa398">        <h2 class="mdl-card__title-text">${name}</h2>    </div>    <div class="mdl-card__supporting-text mdl-card--expand">    Kennungs-Nummer: ${id}    <hr>Von: ${creator}    <hr>Kategorie: ${category}    <hr>        ${description}    </div>    <div class="mdl-card__actions mdl-card--border">        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="playAQuiz(${id})">            Play        </button>        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="deleteAQuiz(${id},this)">            L&ouml;schen        </button>    </div></div>',catElementTmpl='<div class="mdl-cell mdl-cell--4-col-desktop mdl-cell--4-col-tablet mdl-cell--6-col-phone mdl-card mdl-shadow--2dp  graybox ">    <div name="QuizCategory" class="mdl-card__title max-height " style="background: linear-gradient(0deg,${Color}44,${Color}77),url(img/quiz.jpg)bottom right 15% no-repeat #2fa398">        <h2 class="mdl-card__title-text">${name}</h2>    </div>    <div class="mdl-card__actions mdl-card--border">        <button class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="sortCategory(${id})">            Kategorie Anzeigen        </button>    </div></div>',questionElemTmpl='<div name="QuizPlay" class="mdl-cell mdl-card mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--12-col-phone mdl-shadow--2dp  graybox">                            <div name="QuizPlay" class="mdl-card__title max-height " style="background: linear-gradient(0deg,#FFFFFF44,#FFFFFF77),url(img/quiz.jpg)bottom right 15% repeat #2fa398">                                <h2 class="mdl-card__title-text">Frage:</h2>                            </div>                            <div class="mdl-card__supporting-text mdl-card--expand">                            ${text}                            <hr>                            <div id="Frage${id}" data-questionid=${id}>{{each answers }}                            <label>                                    <input name="quizBox" data-answerid="${id}" type="checkbox"><span>${text}</span>                            </label><br>                            {{/each}}                            </div>                            </div>                            <div class="mdl-card__actions mdl-card--border">                                <button id="lock${id}" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="LockQuestion(\'${id}\'); ">                                    Einlocken                                </button>                            </div>                    </div>',quizSubmissionTempl='<div name="QuizPlay" class="mdl-cell mdl-card mdl-cell--12-col-desktop mdl-cell--12-col-tablet mdl-cell--12-col-phone mdl-shadow--2dp  graybox"><div name="QuizPlay" class="mdl-card__title max-height " style="background: linear-gradient(0deg,#FFFFFF44,#FFFFFF77),url(img/quiz.jpg)bottom right 15% repeat #2fa398">    <h2 class="mdl-card__title-text">Abgabe</h2></div><div class="mdl-card__supporting-text mdl-card--expand">    Hier kann das Quiz abgegeben werden. Dazu m&uuml;ssen alle Antworten eingelockt sein.    Alternativ kann das Quiz abgebrochen werden. </div><div class="mdl-card__actions mdl-card--border">    <button id="enterQuiz" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="submitQuiz(); ">        Abgeben    </button>    <button id="cancelQuizBottom"  onclick="cancelQuiz()" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">        Quiz Abbrechen    </button></div></div>',globalSet=!1,quizActive=!1,loggedIn=!1,logToken="",creationRunningId=0,progressQuiz=0;function LockQuestion(e){$("#Frage"+e).children().children("input[type=checkbox]").attr("disabled",!0),$("#Frage"+e).attr("style","background: #00000022"),$("#lock"+e).attr("disabled",!0),progressQuiz++;var t=document.querySelector(".mdl-js-snackbar"),l={message:"Fortschritt: "+progressQuiz+" von "+quests.length+" Fragen",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:2e3};t.MaterialSnackbar.showSnackbar(l)}function toArr(e){return $.map(e,function(e,t){return[e]})}function shuffle(e){for(var t,l,a=e.length;0!==a;)l=Math.floor(Math.random()*a),t=e[a-=1],e[a]=e[l],e[l]=t;return e}var loggedInView=function(e){$('[data-login="true"]').show(),$('[data-login="false"]').hide(),$("#LogoutButton").html(e+" abmelden")},loggedOutView=function(){$('[data-login="false"]').show(),$('[data-login="true"]').hide()},getRandomColor=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},cancelQuiz=function(){$("#questionGrid").fadeOut(500),$("#mainGrid").fadeIn(1e3),$("[name=QuizPlay]").remove(),$("#cancelQuiz").hide(),quizActive=!1},playAQuiz=function(e){getFullQuizById(e,function(e){$("#mainGrid").hide(),$("#questionGrid").show(),$("#cancelQuiz").show(),quizActive=!0,"string"==typeof e&&(e=JSON.parse(e));var t=toArr(e[5]);t=shuffle(t),quests=t;for(var l=progressQuiz=0;l<t.length;l++)$.tmpl(questionElemTmpl,t[l]).appendTo("#questionGrid");$.tmpl(quizSubmissionTempl,{}).appendTo("#questionGrid")})},displayQuizzes=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e;globalQuizLoad=e,globalSet=!0;for(var l=0;l<t.length;l++){var a=t[l];a.Color=getRandomColor(),$.tmpl(listElementTmpl,a).appendTo("#mainGrid")}},searchDisplayQuizzes=function(e){"string"==typeof e&&(e=JSON.parse(e));for(var t=e,l=0;l<t.length;l++){var a=t[l];a.Color=getRandomColor(),$.tmpl(listElementTmpl,a).appendTo("#mainGrid")}},displayOwnQuizzes=function(e){"string"==typeof e&&(e=JSON.parse(e));for(var t=e,l=0;l<t.length;l++){var a=t[l];a.Color=getRandomColor(),$.tmpl(ownElementTmpl,a).appendTo("#mainGrid")}},submitQuiz=function(){if(1==quizActive){for(var e=0,t=0;t<quests.length;t++)$("#Frage"+quests[t].id).children().children("input[type=checkbox]").is(":disabled")&&e++;if(e>=quests.length){for(var l=0,a=0;a<quests.length;a++)if($("#Frage"+quests[a].id).children().children("input[type=checkbox]").is(":disabled")){for(var i=!0,n=0;n<quests[a].answers.length;n++)console.log(quests[a].answers[n].text),1==$("[data-answerid="+quests[a].answers[n].id+"]").is(":checked")?1==quests[a].answers[n].is_correct||(i=!1):(console.log("Is Correct? "+quests[a].answers[n].is_correct),0==quests[a].answers[n].is_correct||(i=!1));1==i&&(console.log("+1!"),l++)}console.log("Fragen richtig: "+l+" von "+quests.length);var o=document.querySelector(".mdl-js-snackbar"),r={message:l+" Fragen von "+quests.length+" korrekt beantwortet",actionHandler:function(e){o.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};o.MaterialSnackbar.showSnackbar(r),cancelQuiz()}else{r={message:"Nicht alle Fragen eingelockt!",actionHandler:function(e){o.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(o=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(r)}}else{r={message:"Unbekannter Fehler, bitte Quiz neu starten.",actionHandler:function(e){o.MaterialSnackbar.cleanup_()},actionText:"Ups!",timeout:5e3};(o=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(r)}};function addQuestion(){$.tmpl(newQuestionTemplate,{rid:creationRunningId}).appendTo("#createInsert"),creationRunningId++,componentHandler.upgradeDom()}function cancelCreateQuiz(){creationRunningId=0,$('[name="newQuestion"]').remove(),$("#CreateView").hide(),$("#mainGrid").html(""),$("#mainGrid").show(),searchDisplayQuizzes(globalQuizLoad),$("#Oview").show()}function hideCreateQuiz(){creationRunningId=0,$('[name="newQuestion"]').remove(),$("#CreateView").hide(),$("#mainGrid").show()}var callCreateQuiz=function(){cancelCreateQuiz(),cancelQuiz(),$("#mainGrid").hide(),$("#CreateView").show(),addQuestion()};function saveQuiz(){var e=!0;""!=$("#newTitle").val().trim()&&""!=$("#newCategory").val().trim()||(e=!1);for(var t=0;t<creationRunningId;t++){var l=$("#moneRunid"+t).val(),a=$("#moneswitchRunid"+t).prop("checked"),i=$("#mtwoRunid"+t).val(),n=$("#mtwoswitchRunid"+t).prop("checked"),o=$("#mthreeRunid"+t).val(),r=$("#mthreeswitchRunid"+t).prop("checked"),d=$("#mfourRunid"+t).val(),c=$("#mfourswitchRunid"+t).prop("checked"),s=$("#questionRunid"+t).val();""!=l.trim()&&""!=i.trim()&&""!=o.trim()&&""!=d.trim()||(e=!1),""==s.trim()&&(e=!1),a||n||r||c||(e=!1)}if(1==e){addQuiz($("#newTitle").val(),$("#newDesc").val(),$("#newCategory").val(),logToken,function(e){if("string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0])console.log("Could not create quiz");else for(var t=e[1],l=0;l<creationRunningId;l++)addRemoteQuestion($("#questionRunid"+l).val(),t,logToken,function(e,t){if("string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0]);else{var l=e[1],a=$("#moneRunid"+t).val(),i=$("#moneswitchRunid"+t).prop("checked"),n=$("#mtwoRunid"+t).val(),o=$("#mtwoswitchRunid"+t).prop("checked"),r=$("#mthreeRunid"+t).val(),d=$("#mthreeswitchRunid"+t).prop("checked"),c=$("#mfourRunid"+t).val(),s=$("#mfourswitchRunid"+t).prop("checked");addAnswer(a,i,l,logToken,function(e){console.log("aw 1 callback"),"string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0]&&console.log("Erstellung von AW 1 fehlgeschlagen")}),addAnswer(n,o,l,logToken,function(e){console.log("aw 2 callback"),"string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0]&&console.log("Erstellung von AW 2 fehlgeschlagen")}),addAnswer(r,d,l,logToken,function(e){console.log("aw 3 callback"),"string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0]&&console.log("Erstellung von AW 3 fehlgeschlagen")}),addAnswer(c,s,l,logToken,function(e){console.log("aw 4 callback"),"string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0]&&console.log("Erstellung von AW 4 fehlgeschlagen")})}},l)}),$("#CreateView").hide(),$("#mainGrid").html(""),$("#mainGrid").show(),getFullQuizzes(displayQuizzes);var u={message:"Quiz gespeichert!",actionHandler:function(e){m.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(m=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(u)}else{var m;u={message:"Titel des Quiz darf nicht leer sein, Kategorie darf nicht leer sein, Pro Frage mindestens eine korrekte Antwort, Alle Antwortmöglichkeiten müssen ausgefüllt sein",actionHandler:function(e){m.MaterialSnackbar.cleanup_()},actionText:"ok",timeout:1e4};(m=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(u)}}function sortCategory(e){cancelQuiz(),cancelCreateQuiz();var t=e;if(console.log("cid: "+e),""==t)$("#mainGrid").html(""),searchDisplayQuizzes(globalQuizLoad);else{var l=globalQuizLoad.filter(function(e){return e.category_idcategory.includes(t)});$("#mainGrid").html(""),searchDisplayQuizzes(l),0==l.length&&$("#mainGrid").text("Kein Ergebnis gefunden :(")}}function deleteAQuiz(e,t){deleteQuiz(e,logToken,function(e){if("string"==typeof e&&(e=JSON.parse(e)),"ok"==e[0]){e={message:"Quiz gelöscht",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:2e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}else{var t;e={message:"Unbekannter Fehler",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"ok",timeout:2e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}}),$(t).parent().parent().fadeOut(500)}$(function(){getFullQuizzes(displayQuizzes),$("#login").dialog({autoOpen:!1,modal:!0,closeOnEscape:!0,draggable:!1,resizable:!1,width:"auto",buttons:[{text:"Anmelden",click:function(){loginUser($("#uname").val(),$("#pass").val(),function(e){if("string"==typeof e&&(e=JSON.parse(e)),"ok"==e[0]){loggedInView($("#uname").val()),loggedIn=!0,logToken=e[1],logID=e[2];var t=document.querySelector(".mdl-js-snackbar");e={message:"Nutzer erfolgreich angemeldet!",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};t.MaterialSnackbar.showSnackbar(e)}}),$(this).dialog("close")}},{text:"Registrieren",click:function(){console.log("Register click"),getUserByName($("#uname").val(),function(e){if("string"==typeof e&&(e=JSON.parse(e)),"failed"==e[0])addUser($("#uname").val(),$("#pass").val(),"A new user",function(e){if("string"==typeof e&&(e=JSON.parse(e)),console.log(e),"ok"==e[0]){e={message:"Nutzer erfolgreich angelegt! Bitte anmelden.",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}else{var t;e={message:"Unbekannter Fehler bei Registrierung!",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}});else{var t=document.querySelector(".mdl-js-snackbar");e={message:"Nutzername existiert bereits!",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};t.MaterialSnackbar.showSnackbar(e)}}),$(this).dialog("close")}},{text:"Abbrechen",click:function(){$(this).dialog("close")}}]}),$('[name="goToLogin"]').click(function(){return $("#login").dialog("open"),!1}),$("#LogoutButton").click(function(){logoutUser(logToken,function(e){if("string"==typeof e&&(e=JSON.parse(e)),"ok"==e[0]){loggedOutView(),cancelQuiz(),cancelCreateQuiz(),loggedIn=!1,logToken="";e={message:"Erfolreich abgemeldet",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}else{var t;e={message:"Fehler! Neu laden zum abmelden.",actionHandler:function(e){t.MaterialSnackbar.cleanup_()},actionText:"Ok",timeout:5e3};(t=document.querySelector(".mdl-js-snackbar")).MaterialSnackbar.showSnackbar(e)}})}),$('[name="Overview"]').click(function(){cancelQuiz(),$("#mainGrid").html(""),searchDisplayQuizzes(globalQuizLoad),$("#Oview").show(),hideCreateQuiz()}),$("#barSearch").click(function(){$("#barSearchInput >form :input").val(""),$("#barSearchInput").fadeIn(500)}),$("#barSearchInput").submit(function(){cancelQuiz(),cancelCreateQuiz();var t=$("#barInputLine").val();if(""==t.trim())$("#mainGrid").html(""),searchDisplayQuizzes(globalQuizLoad);else{var e=globalQuizLoad.filter(function(e){return e.name.includes(t)||e.id.includes(t)||e.category.includes(t)||e.category.includes(t)});$("#mainGrid").html(""),searchDisplayQuizzes(e),0==e.length&&$("#mainGrid").text("Kein Ergebnis gefunden :(")}$(this).fadeOut(500)}),$("#ownQuiz").click(function(){cancelQuiz(),cancelCreateQuiz();var t=logID;if(""==t.trim())$("#mainGrid").html(""),searchDisplayQuizzes(globalQuizLoad);else{var e=globalQuizLoad.filter(function(e){return e.user_iduser.includes(t)});$("#mainGrid").html(""),displayOwnQuizzes(e),0==e.length&&$("#mainGrid").text("Kein Ergebnis gefunden :(")}}),$("#categoryView").click(function(){console.log("click"),allCategory(function(e){console.log(e),"string"==typeof e&&(e=JSON.parse(e)),$("#mainGrid").html("");for(var t=0;t<e.length;t++)console.log(e[t]),e[t].Color=getRandomColor(),$.tmpl(catElementTmpl,e[t]).appendTo("#mainGrid")})})});